[2025-10-17T15:23:16.565+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-10-17T15:23:17.026+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: jobs_jobspy_daily.collect_jobspy manual__2025-10-17T15:23:12.660068+00:00 [queued]>
[2025-10-17T15:23:17.116+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: jobs_jobspy_daily.collect_jobspy manual__2025-10-17T15:23:12.660068+00:00 [queued]>
[2025-10-17T15:23:17.118+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 1
[2025-10-17T15:23:17.223+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): collect_jobspy> on 2025-10-17 15:23:12.660068+00:00
[2025-10-17T15:23:17.304+0000] {logging_mixin.py:188} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:62 DeprecationWarning: This process (pid=176) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-10-17T15:23:17.271+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'jobs_jobspy_daily', 'collect_jobspy', 'manual__2025-10-17T15:23:12.660068+00:00', '--job-id', '27', '--raw', '--subdir', 'DAGS_FOLDER/jobs_jobspy_daily.py', '--cfg-path', '/tmp/tmpoz9s_oh0']
[2025-10-17T15:23:17.308+0000] {standard_task_runner.py:91} INFO - Job 27: Subtask collect_jobspy
[2025-10-17T15:23:17.308+0000] {standard_task_runner.py:64} INFO - Started process 177 to run task
[2025-10-17T15:23:17.704+0000] {task_command.py:426} INFO - Running <TaskInstance: jobs_jobspy_daily.collect_jobspy manual__2025-10-17T15:23:12.660068+00:00 [running]> on host bddbbd4b28cf
[2025-10-17T15:23:18.173+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='jobs_jobspy_daily' AIRFLOW_CTX_TASK_ID='collect_jobspy' AIRFLOW_CTX_EXECUTION_DATE='2025-10-17T15:23:12.660068+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-10-17T15:23:12.660068+00:00'
[2025-10-17T15:23:18.178+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-10-17T15:23:18.355+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-10-17T15:23:18.358+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', "python /workspace/scripts/jobspy_collect.py --queries 'Data Engineer,Data Scientist,ML Engineer,DevOps Engineer,Backend Developer' --locations 'France,Remote,Paris' --sites indeed,glassdoor,linkedin --pages 4 --days 21 --max_per_query 1000"]
[2025-10-17T15:23:18.394+0000] {subprocess.py:86} INFO - Output:
[2025-10-17T15:24:46.790+0000] {subprocess.py:93} INFO - 2025-10-17 15:24:46,788 - INFO - JobSpy:Linkedin - finished scraping
[2025-10-17T15:26:03.979+0000] {subprocess.py:93} INFO - [OK] 514 rows → /workspace/datalake/raw/jobs/ingest_date=2025-10-17/jobspy_Data_Engineer_France.jsonl
[2025-10-17T15:26:03.982+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-10-17T15:26:03.985+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.12/site-packages/jobspy/linkedin/__init__.py", line 157, in scrape
[2025-10-17T15:26:04.027+0000] {subprocess.py:93} INFO -     job_post = self._process_job(job_card, job_id, fetch_desc)
[2025-10-17T15:26:04.029+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-17T15:26:04.031+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.12/site-packages/jobspy/linkedin/__init__.py", line 204, in _process_job
[2025-10-17T15:26:04.033+0000] {subprocess.py:93} INFO -     location = self._get_location(metadata_card)
[2025-10-17T15:26:04.036+0000] {subprocess.py:93} INFO -                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-17T15:26:04.039+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.12/site-packages/jobspy/linkedin/__init__.py", line 320, in _get_location
[2025-10-17T15:26:04.041+0000] {subprocess.py:93} INFO -     country = Country.from_string(country)
[2025-10-17T15:26:04.043+0000] {subprocess.py:93} INFO -               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-17T15:26:04.044+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.12/site-packages/jobspy/model.py", line 176, in from_string
[2025-10-17T15:26:04.047+0000] {subprocess.py:93} INFO -     raise ValueError(
[2025-10-17T15:26:04.049+0000] {subprocess.py:93} INFO - ValueError: Invalid country string: 'moldova'. Valid countries are: argentina, australia, austria, bahrain, bangladesh, belgium, bulgaria, brazil, canada, chile, china, colombia, costa rica, croatia, cyprus, czech republic,czechia, denmark, ecuador, egypt, estonia, finland, france, germany, greece, hong kong, hungary, india, indonesia, ireland, israel, italy, japan, kuwait, latvia, lithuania, luxembourg, malaysia, malta, mexico, morocco, netherlands, new zealand, nigeria, norway, oman, pakistan, panama, peru, philippines, poland, portugal, qatar, romania, saudi arabia, singapore, slovakia, slovenia, south africa, south korea, spain, sweden, switzerland, taiwan, thailand, türkiye,turkey, ukraine, united arab emirates, uk,united kingdom, usa,us,united states, uruguay, venezuela, vietnam, usa/ca, worldwide
[2025-10-17T15:26:04.051+0000] {subprocess.py:93} INFO - 
[2025-10-17T15:26:04.053+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-10-17T15:26:04.055+0000] {subprocess.py:93} INFO - 
[2025-10-17T15:26:04.057+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-10-17T15:26:04.059+0000] {subprocess.py:93} INFO -   File "/workspace/scripts/jobspy_collect.py", line 75, in <module>
[2025-10-17T15:26:04.061+0000] {subprocess.py:93} INFO -     main()
[2025-10-17T15:26:04.063+0000] {subprocess.py:93} INFO -   File "/workspace/scripts/jobspy_collect.py", line 36, in main
[2025-10-17T15:26:04.065+0000] {subprocess.py:93} INFO -     df = scrape_jobs(
[2025-10-17T15:26:04.067+0000] {subprocess.py:93} INFO -          ^^^^^^^^^^^^
[2025-10-17T15:26:04.073+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.12/site-packages/jobspy/__init__.py", line 125, in scrape_jobs
[2025-10-17T15:26:04.075+0000] {subprocess.py:93} INFO -     site_value, scraped_data = future.result()
[2025-10-17T15:26:04.077+0000] {subprocess.py:93} INFO -                                ^^^^^^^^^^^^^^^
[2025-10-17T15:26:04.079+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 449, in result
[2025-10-17T15:26:04.080+0000] {subprocess.py:93} INFO -     return self.__get_result()
[2025-10-17T15:26:04.082+0000] {subprocess.py:93} INFO -            ^^^^^^^^^^^^^^^^^^^
[2025-10-17T15:26:04.084+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
[2025-10-17T15:26:04.086+0000] {subprocess.py:93} INFO -     raise self._exception
[2025-10-17T15:26:04.088+0000] {subprocess.py:93} INFO -   File "/usr/local/lib/python3.12/concurrent/futures/thread.py", line 58, in run
[2025-10-17T15:26:04.089+0000] {subprocess.py:93} INFO -     result = self.fn(*self.args, **self.kwargs)
[2025-10-17T15:26:04.090+0000] {subprocess.py:93} INFO -              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-17T15:26:04.091+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.12/site-packages/jobspy/__init__.py", line 116, in worker
[2025-10-17T15:26:04.092+0000] {subprocess.py:93} INFO -     site_val, scraped_info = scrape_site(site)
[2025-10-17T15:26:04.094+0000] {subprocess.py:93} INFO -                              ^^^^^^^^^^^^^^^^^
[2025-10-17T15:26:04.095+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.12/site-packages/jobspy/__init__.py", line 107, in scrape_site
[2025-10-17T15:26:04.096+0000] {subprocess.py:93} INFO -     scraped_data: JobResponse = scraper.scrape(scraper_input)
[2025-10-17T15:26:04.097+0000] {subprocess.py:93} INFO -                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2025-10-17T15:26:04.098+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.12/site-packages/jobspy/linkedin/__init__.py", line 163, in scrape
[2025-10-17T15:26:04.099+0000] {subprocess.py:93} INFO -     raise LinkedInException(str(e))
[2025-10-17T15:26:04.100+0000] {subprocess.py:93} INFO - jobspy.exception.LinkedInException: Invalid country string: 'moldova'. Valid countries are: argentina, australia, austria, bahrain, bangladesh, belgium, bulgaria, brazil, canada, chile, china, colombia, costa rica, croatia, cyprus, czech republic,czechia, denmark, ecuador, egypt, estonia, finland, france, germany, greece, hong kong, hungary, india, indonesia, ireland, israel, italy, japan, kuwait, latvia, lithuania, luxembourg, malaysia, malta, mexico, morocco, netherlands, new zealand, nigeria, norway, oman, pakistan, panama, peru, philippines, poland, portugal, qatar, romania, saudi arabia, singapore, slovakia, slovenia, south africa, south korea, spain, sweden, switzerland, taiwan, thailand, türkiye,turkey, ukraine, united arab emirates, uk,united kingdom, usa,us,united states, uruguay, venezuela, vietnam, usa/ca, worldwide
[2025-10-17T15:26:04.428+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-10-17T15:26:04.434+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-10-17T15:26:04.483+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-10-17T15:26:04.508+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=jobs_jobspy_daily, task_id=collect_jobspy, run_id=manual__2025-10-17T15:23:12.660068+00:00, execution_date=20251017T152312, start_date=20251017T152317, end_date=20251017T152604
[2025-10-17T15:26:04.558+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 27 for task collect_jobspy (Bash command failed. The command returned a non-zero exit code 1.; 177)
[2025-10-17T15:26:04.585+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 1
[2025-10-17T15:26:04.680+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-17T15:26:04.691+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
